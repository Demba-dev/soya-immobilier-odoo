<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- =========================================== -->
        <!-- RAPPORT : QUITTANCE DE LOYER - 1 PAGE -->
        <!-- =========================================== -->

        <!-- Template QWeb pour la quittance de loyer -->
        <template id="report_financial_invoice">
            <t t-call="web.html_container">
                <t t-call="web.external_layout">
                    <div class="page" style="padding: 15px; font-size: 12px;">
                        
                        <!-- En-tête compact -->
                        <div class="row" style="margin-bottom: 20px; border-bottom: 2px solid #2C3E50; padding-bottom: 15px;">
                            <div class="col-8">
                                <h1 style="color: #2C3E50; font-size: 20px; font-weight: bold; margin: 0 0 10px 0;">
                                    QUITTANCE DE LOYER
                                </h1>
                                <div style="display: flex; gap: 20px; font-size: 11px;">
                                    <div>
                                        <strong>Réf:</strong> <span t-field="docs[0].name"/>
                                    </div>
                                    <div>
                                        <strong>Émission:</strong> <span t-field="docs[0].invoice_date"/>
                                    </div>
                                    <div>
                                        <strong>Période:</strong> <span t-field="docs[0].period_start"/> à <span t-field="docs[0].period_end"/>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-4 text-right">
                                <img t-att-src="'/soya_estate/static/description/soya_logo.png'"
                                     style="max-height: 50px; max-width: 150px; margin-bottom: 5px;"/>
                                <div style="font-size: 11px; color: #6c757d;">
                                    <strong t-field="docs[0].company_id.name"/><br/>
                                    <span t-field="docs[0].company_id.street"/>, <span t-field="docs[0].company_id.city"/>
                                </div>
                            </div>
                        </div>

                        <!-- Parties en ligne -->
                        <div class="row" style="margin-bottom: 15px;">
                            <div class="col-6">
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 5px; border-left: 3px solid #3498DB;">
                                    <strong style="color: #2C3E50; display: block; margin-bottom: 5px;">LOCATAIRE</strong>
                                    <strong t-field="docs[0].partner_id.name"/><br/>
                                    <span t-field="docs[0].partner_id.street"/><br/>
                                    <span t-field="docs[0].partner_id.city"/><br/>
                                    <small>Tél: <span t-field="docs[0].partner_id.phone"/></small>
                                </div>
                            </div>
                            
                            <div class="col-6">
                                <div style="background: #f8f9fa; padding: 12px; border-radius: 5px; border-left: 3px solid #E74C3C;">
                                    <strong style="color: #2C3E50; display: block; margin-bottom: 5px;">PROPRIÉTAIRE</strong>
                                    <strong t-field="docs[0].contract_id.landlord_id.name"/><br/>
                                    <span t-field="docs[0].contract_id.landlord_id.street"/><br/>
                                    <span t-field="docs[0].contract_id.landlord_id.city"/><br/>
                                    <small>Tél: <span t-field="docs[0].contract_id.landlord_id.phone"/></small>
                                </div>
                            </div>
                        </div>

                        <!-- Bien immobilier compact -->
                        <div class="row" style="margin-bottom: 15px;">
                            <div class="col-12">
                                <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; border-left: 3px solid #27AE60;">
                                    <strong style="color: #2C3E50;">BIEN LOUÉ: </strong>
                                    <span t-field="docs[0].property_id.name"/> - 
                                    <span t-field="docs[0].property_id.street"/>, 
                                    <span t-field="docs[0].property_id.city"/> - 
                                    <strong>Type:</strong> <span t-field="docs[0].property_id.property_type_id.name"/>
                                    <span t-if="docs[0].property_id.living_area" style="margin-left: 10px;">
                                        <strong>Surface:</strong> <span t-field="docs[0].property_id.living_area"/> m²
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Tableau financier compact -->
                        <div class="row" style="margin-bottom: 15px;">
                            <div class="col-12">
                                <table style="width: 100%; border-collapse: collapse; background: white; font-size: 11px;">
                                    <thead>
                                        <tr style="background: #2C3E50; color: white;">
                                            <th style="padding: 10px; text-align: left; border: none;">DESCRIPTION</th>
                                            <th style="padding: 10px; text-align: right; border: none; width: 120px;">MONTANT (FCFA)</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 10px; border: none;">
                                                Loyer mensuel HT
                                            </td>
                                            <td style="padding: 10px; text-align: right; border: none; font-weight: bold;">
                                                <span t-field="docs[0].contract_id.monthly_rent" 
                                                      t-options="{'widget': 'monetary', 'display_currency': docs[0].currency_id}"/>
                                            </td>
                                        </tr>

                                        <tr t-if="docs[0].tax_amount > 0" style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 10px; border: none;">
                                                TVA (18%)
                                            </td>
                                            <td style="padding: 10px; text-align: right; border: none;">
                                                <span t-field="docs[0].tax_amount" 
                                                    t-options="{'widget': 'monetary', 'display_currency': docs[0].currency_id}"/>
                                            </td>
                                        </tr>


                                        <tr t-if="docs[0].contract_id.charges_amount > 0" style="border-bottom: 1px solid #e9ecef;">
                                            <td style="padding: 10px; border: none;">
                                                Charges diverses
                                            </td>
                                            <td style="padding: 10px; text-align: right; border: none;">
                                                <span t-field="docs[0].contract_id.charges_amount" 
                                                      t-options="{'widget': 'monetary', 'display_currency': docs[0].currency_id}"/>
                                            </td>
                                        </tr>
                                        <tr style="background: #f8f9fa; border-top: 2px solid #E0E0CE;">
                                            <td style="padding: 10px; border: none;">
                                                <strong style="color: #E0E0CE;">TOTAL À PAYER</strong>
                                            </td>
                                            <td style="padding: 10px; text-align: right; border: none;">
                                                <strong style="color: #E0E0CE; font-size: 13px;">
                                                    <span t-field="docs[0].total_amount" 
                                                          t-options="{'widget': 'monetary', 'display_currency': docs[0].currency_id}"/>
                                                </strong>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- Note sur la TVA -->
                                <div style="text-align: center; margin-top: 5px;">
                                    <small style="color: #6c757d; font-size: 9px;">
                                        <em>HT: Hors Taxes - TTC: Toutes Taxes Comprises - TVA applicable: 18%</em>
                                    </small>
                                </div>
                            </div>
                        </div>

                        <!-- Informations de paiement compactes -->
                        <div class="row" style="margin-bottom: 20px;">
                            <div class="col-12">
                                <div style="background: #3498DB; color: white; padding: 12px; border-radius: 5px; font-size: 11px;">
                                    <div class="row" style="margin: 0;">
                                        <div class="col-3" style="padding: 0 8px;">
                                            <strong>Date limite:</strong><br/>
                                            <span t-field="docs[0].due_date" style="font-weight: bold;"/>
                                        </div>
                                        <div class="col-3" style="padding: 0 8px;">
                                            <strong>Mode paiement:</strong><br/>
                                            Virement/Espèces
                                        </div>
                                        <div class="col-3" style="padding: 0 8px;">
                                            <strong>Référence:</strong><br/>
                                            <span t-field="docs[0].name" style="font-weight: bold;"/>
                                        </div>
                                        <div class="col-3" style="padding: 0 8px;">
                                            <strong>Contrat:</strong><br/>
                                            <span t-field="docs[0].contract_id.name"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Signatures compactes -->
                        <div class="row" style="margin-top: 25px;">
                            <div class="col-6">
                                <div style="text-align: center;">
                                    <p style="margin: 0 0 40px 0; font-weight: bold; font-size: 11px;">Le Locataire</p>
                                    <div style="border-top: 1px solid #2C3E50; width: 150px; margin: 0 auto;">
                                        <small><em>Signature</em></small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div style="text-align: center;">
                                    <p style="margin: 0 0 40px 0; font-weight: bold; font-size: 11px;">Pour SOYA Immobilier</p>
                                    <div style="border-top: 1px solid #2C3E50; width: 150px; margin: 0 auto;">
                                        <small><em>Cachet et signature</em></small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pied de page ultra compact -->
                        <div class="row" style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #e9ecef;">
                            <div class="col-12 text-center">
                                <small style="color: #6c757d; font-size: 9px; line-height: 1.3;">
                                    <strong>SOYA Immobilier</strong> - BP 1234 Bamako - Tél: +223 20 21 22 23 - Email: contact@soya.ml<br/>
                                    Quittance émise le <span t-field="docs[0].invoice_date"/> - Document faisant foi
                                </small>
                            </div>
                        </div>

                    </div>
                </t>
            </t>
        </template>

        <!-- Action de rapport (inchangée) -->
        <record id="action_report_financial_invoice" model="ir.actions.report">
            <field name="name">Quittance de Loyer</field>
            <field name="model">soya.financial.invoice</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">soya_estate.report_financial_invoice</field>
            <field name="print_report_name">'Quittance - %s' % (object.name if object else docs[0].name)</field>
            <field name="binding_model_id" ref="model_soya_financial_invoice"/>
            <field name="binding_type">report</field>
        </record>

    </data>
</odoo>